# 一、电池曲线
## 1.1 电压和电量的关系
        非线性关系，在高电量和低电量时，电压变化相对慢
        开路电压（OCV)：在电池没有负载的情况下测得的电压，基于开路电压曲线估算电池电量
        标准电池曲线：电压和电量映射表，固件根据该表来推测电池的当前电量
## 1.2 判断电池曲线是否合适
        使用体验：
            电量估算准确性：如果曲线不准确，可能会出现设备显示电量满格后迅速下降；或者在电量低时仍然显示较高的电量，导致设备突然关机
            耗电时长：如果电池的使用时间明显短于预期，可能是电池曲线不合理，造成电量估算不准确
            电量显示稳定性：在正常使用时电量下降的速度是否合理平稳，如果电量显示出现大幅跳动，曲线可能需要优化
## 1.3 优化电池曲线
        测试不同温度和负载下的电压曲线
        通过软件进行补偿：电池曲线通过软件补偿可以避免因温度、负载等外部因素造成的电量显示不稳定或不准确问题
## 1.4 理解电量显示和电池曲线的关系
智能手表中的电量显示基于客户提供的电池充电和放电曲线，主要通过以下步骤来控制电量显示：

1. 获取电池电压信息
智能手表通过内部传感器实时监测电池的电压。这些传感器会测量当前的电池电压，并将其作为电池电量估算的主要依据。
电池电压监测通常由专用的电池管理系统（BMS）芯片或电压监测 IC 来实现，这些元器件一般集成在智能手表的主板上。它们的主要功能是监测电池的电压、电流和温度等参数
电池电压随电量的变化而变化，因此它是电量估算的关键指标之一。
2. 电池曲线映射
客户提供的电池曲线包括电池在不同电量水平下的电压对应关系。这条曲线通常包含电池从 100% 电量到 0% 电量时的电压变化。
通过将实际测得的电池电压与电池曲线中的电压数据进行匹配，系统可以估算当前电池的剩余电量。例如，如果当前电压与电池曲线上对应的 50% 电量电压相匹配，那么手表会显示 50% 电量。
3. 电压与电量非线性关系
由于锂离子电池的特性，电压与电量的关系并不是线性的。电池的电压在放电初期较高且相对稳定，而在接近低电量时电压下降较快。因此，电量显示需要根据电池曲线来调整。
系统会根据电池曲线的不同部分采用不同的比例来映射电量。例如，电池在 80% 至 100% 之间时，电压变化很小，电量变化较缓，而在低电量时，电压变化较大，电量下降得较快。
4. 温度和负载影响
电池电量的显示还会受到温度和负载的影响。高温或低温可能导致电池电压波动，进而影响电量估算的准确性。
另外，当手表处于高功耗状态（如使用 GPS、心率监测等功能）时，电池电压会暂时下降，可能导致电量显示突然变少。为了平衡这种影响，系统会进行滤波和校正，使电量显示更加平稳。
5. 充电过程中的电量显示
在充电过程中，系统同样根据电池曲线来更新电量显示。快速充电阶段电量增加较快，而在接近满电时，电量增长变慢，这是因为充电电流逐渐减小，系统会根据实际电压和充电速率调整电量显示的变化速度。


# 二、SDK开发
1. 获取 SDK 文档和库文件
从供应商处获取 SDK 包，通常包含以下内容：
SDK 库文件：用于集成到你的应用中，可能是 .jar、.framework 或其他编译好的库文件。
开发文档：包括如何集成、使用 API、常见问题等。仔细阅读文档，了解如何与硬件设备（智能戒指）进行交互。
示例代码：供应商通常提供一些示例代码，展示如何在应用中使用 SDK 功能，特别是连接设备、获取数据等功能。
2. 设置开发环境
确保你的开发环境（如 Android Studio、Xcode 等）已经设置好。
在项目中导入 SDK 文件：
Android：将 .jar 或 .aar 文件添加到 libs 文件夹中，并在 build.gradle 文件中配置依赖。
iOS：将 .framework 文件拖入 Xcode 项目的 “Frameworks, Libraries, and Embedded Content” 部分。
3. 初始化 SDK
大多数 SDK 需要在应用启动时进行初始化，通常在 MainActivity 或 AppDelegate 中完成：
Android：在 onCreate() 方法中调用 SDK 的初始化方法。
iOS：在 didFinishLaunchingWithOptions 方法中初始化 SDK。
例如，某些 SDK 可能需要你传入 API 密钥或配置信息，确保从文档中找到并正确配置。
4. 连接设备
智能戒指通常通过蓝牙与手机通信，因此你需要在 APP 中实现设备连接逻辑：

扫描设备：使用 SDK 提供的 API 扫描附近的蓝牙设备。
连接设备：一旦找到智能戒指设备，通过设备 ID 或 MAC 地址发起连接。
设备授权：某些智能设备可能需要用户授权访问传感器数据，这通常是通过 SDK 提供的授权接口实现的。
5. 读取数据
一旦设备连接成功，你可以开始从戒指设备中读取数据：

传感器数据：SDK 会提供 API 让你获取如心率、睡眠、步数等传感器数据。根据文档中的说明，调用相应方法获取数据。
回调接口：通常数据获取是通过异步回调接口返回的，你需要实现这些回调函数来处理设备发回的数据。
6. 处理数据和显示
在获取到数据后，你可以将其展示在 UI 上，或处理后上传到服务器进行进一步分析。
确保你处理好异常情况，比如连接失败、数据获取超时等。
7. 测试与调试
在开发完成后，测试与智能戒指的连接是否稳定，数据获取是否准确。
使用供应商提供的调试工具或日志功能，确保设备与 SDK 之间的通信正常。
8. 其他功能
了解 SDK 是否提供其他功能，如固件升级、设备管理等，确保你充分利用这些功能进行开发。
9. 发布和维护
在发布 APP 之前，确保供应商的 SDK 使用符合相应的协议或授权要求，并定期检查供应商的 SDK 更新，确保你的 APP 与硬件保持兼容。
通过上述步骤，逐步集成供应商提供的 SDK，可以高效开发你的智能戒指 APP。

# 三、智能戒指的layout原理图
# 四、智能手表的屏调试
“撕裂”问题，通常是由于屏幕刷新率与帧率不同步，导致图像在显示过程中不连续或错位。屏幕还未完全刷新一帧图像时，下一帧数据已经开始渲染。具体表现为在滑动或动画效果中，屏幕的图像显示不完整或出现分割现象。
刷新意味着屏幕硬件每次从帧缓冲区中取出当前可显示的图像并绘制到屏幕上
---帧（Frame）是指一幅完整的图像。在任何视频或动画系统中，帧代表着在某一瞬间显示的图像，而通过连续快速显示一系列帧，形成流畅的运动效果。帧的单位通常涉及时间，比如每秒显示的帧数，即帧率（Frame Rate），用**fps（frames per second）**表示。帧率指的是图像生成的速度
---刷新率（Refresh Rate）则是显示器每秒更新屏幕图像的次数，通常用**Hz（赫兹）**表示。例如，60Hz的刷新率意味着显示器每秒钟能够更新60次画面。
撕裂问题可能来自以下几个方面：

刷新率不匹配：屏幕的刷新频率（通常为60Hz或更高）与GPU或CPU渲染图像的帧率不同步。
图形缓冲区切换不当：图像缓冲区（frame buffer）没有在适当的时机进行更新，导致在屏幕未完全刷新前切换到新的图像帧。
屏幕驱动未正确处理同步信号：屏幕驱动程序可能没有正确处理V-Sync（垂直同步）信号，导致图像渲染与刷新不匹配。
2. 从屏幕驱动层面的调试步骤
1. 启用V-Sync（垂直同步）
原理：

当应用程序生成图像的帧率高于屏幕刷新率时，V-Sync 会等待屏幕的刷新周期再更新画面。
当帧率低于刷新率时，V-Sync 会保持当前帧显示，直到下一帧完成渲染。

如何处理帧率与刷新率不一致
高帧率 vs. 低刷新率：

如果应用程序的帧率高于屏幕刷新率，比如应用程序渲染 100 FPS，而屏幕刷新率是 60Hz，屏幕在一次刷新周期内接收到多帧图像。如果没有启用 V-Sync，可能会导致屏幕撕裂，因为屏幕可能只显示部分图像。
在屏幕完成一个刷新周期之前，新的帧数据已经写入到帧缓冲区中。屏幕可能会在一次刷新过程中显示一部分旧帧，另一部分显示新帧，从而造成撕裂现象
解决方法：通过启用 V-Sync，将帧率锁定在与刷新率一致的水平（如 60 FPS 对应 60Hz 刷新率），避免过多帧率导致的撕裂。
低帧率 vs. 高刷新率：

如果应用程序的帧率低于屏幕的刷新率，比如应用程序只渲染 30 FPS，但屏幕刷新率为 60Hz，屏幕可能会显示同一个图像两次，导致卡顿现象（Stutter）。
解决方法：
调整应用程序或系统渲染的帧率接近屏幕的刷新率。
使用动态刷新率（如果硬件支持）。一些高端设备支持动态刷新率，能够根据渲染帧率动态调整屏幕刷新率，避免卡顿和撕裂。
双缓冲和三缓冲：

双缓冲通过在两个缓冲区间交替渲染和显示图像，减少屏幕撕裂问题。但如果帧率过高或过低，双缓冲可能会导致延迟。
三缓冲增加了一个额外的缓冲区，减少了等待时间，允许应用程序继续渲染帧，即使当前帧还在显示。这能够平滑帧率波动。

## 4.2 屏接口
QSPI:quad serial peripheral interface
用于微控制器与外设之间的通信，
串行接口，四个数据线，用于高速传输场合，数据可以并行传输，通过时钟信号同步控制，不需要额外的握手信号

8080：并行接口，8位或16位数据线+控制线（CS片选信号，WR读控制，RD写控制），需要控制信号的握手来协调读写操作

QSPI适合高带宽和高速传输的需求，特别是在引脚数量有限的情况下。8080接口则用于需要精确控制的场合，尽管速度较慢，但因其稳定的并行接口特性，仍被广泛应用于显示屏驱动。

# 五、功耗
## 5.1 不同状态下的底电流+平均电流（杰理）
### 5.1.1 不同状态下的底电流
待机底电流（不连接APP）：0.22mA
单屏功耗（去屏去心率）：0.04
连接APP：滑动屏幕后待机：0.22
连接APP+通话蓝牙：待机：0.22-2
息屏时钟：AMOLED：5
关机：0.01
LCD：手电筒界面：2灯45（亮度300）；3灯60（亮度400）；4灯80（亮度300）；AMOLED 100（亮度700）；
持续心率：进入运动模式（1、空测+灭屏 3.5；2、佩戴+灭屏 10）

### 5.1.2 平均电流
不连接APP，平均待机电流3min：0.36
连接APP，平均待机电流3min：0.38
连接APP+通话蓝牙待机电流,持续待机5min：0.4
息屏时钟：AMOLED：5
关机：0.01
GPS定位：灭屏15；亮屏60；

# 六、闪屏现象总结
## 6.1 杰理平台，手表搭在充电器上，会闪一下表盘界面
解决过程：充电第一下闪屏后面不复现的不良现象是软件上面时序有问题，需要软件那边帮忙改一下把Elvdd和Elves，在Swire上电之后多延时几帧再开
目的：确保屏幕驱动电压在主电源稳定后才开启，避免因为时序问题导致的闪烁
理解：swire是指一个供电信号，软件控制的上电信号；Elvdd 和 Elves 是显示面板中常见的电压信号，用于为屏幕提供必要的驱动电压
代码：11 29休眠唤醒的时候加长延时，充电亮屏是要在51前面加延时

# 七、PS
## 7.1 位图：以像素为单位
## 7.2 矢量图：与像素无关
适合制作图标、logo等需要经常缩放，缩放不影响清晰度，存储空间比位图小很多
缺点：不能创建过于复杂的图形
## 7.3 分辨率
单位长度内包含像素点的数量，单位像素/英寸（PPI)
分辨率为72ppi的图像包含72*72个像素
## 7.4 选区
### 7.4.1 魔棒工具：
基于色调和颜色差异来构建选区，可以快速选择色彩变化不大且色调接近的区域
单击，选择-反选就可以选中该区域之外的区域
魔棒工具选择栏：
        取样大小：选择3*3平均，可对光标所在位置3个像素区域内的平均颜色取样
        容差：决定什么样的像素能够与鼠标单击点的色调相近，低时只选择与单击点像素非常相似的少数颜色，值越高对像素相似程度的要求越低
### 7.4.2 快速选择工具：
可以像绘画一样涂抹出选区，拖动鼠标，选区会向外扩展并自动查找和跟随图像中定义的边缘
快速选择工具选择栏：
        自动增强：减少选区边界的粗糙度和块效应